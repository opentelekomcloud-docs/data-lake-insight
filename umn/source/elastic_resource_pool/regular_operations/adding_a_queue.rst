:original_name: dli_01_0509.html

.. _dli_01_0509:

Adding a Queue
==============

You can add one or more queues to an elastic resource pool to run jobs. This section describes how to add a queue to an elastic resource pool.

Precautions
-----------

Automatic scaling of an elastic resource pool cannot be triggered for Flink jobs.


Adding a Queue
--------------

#. In the navigation pane on the left, choose **Resources** > **Resource Pool**.

#. Locate the target elastic resource pool and click **Add Queue** in the **Operation** column.

#. On the **Add Queue** page, configure basic queue information. The following table describes the parameters.

   .. table:: **Table 1** Queue information

      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                                                                                                                         |
      +===================================+=====================================================================================================================================================================================================================================================================================================================+
      | Name                              | Name of the queue to add                                                                                                                                                                                                                                                                                            |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Type                              | -  For SQL: The queue is used to run SQL jobs.                                                                                                                                                                                                                                                                      |
      |                                   | -  General general purpose: The queue is used to run Spark and Flink jobs.                                                                                                                                                                                                                                          |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Engine                            | If **Type** is **For SQL**, the queue engine can be **spark** or **trino**.                                                                                                                                                                                                                                         |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Enterprise Project                | Select the enterprise project the queue belongs to. Queues under different enterprise projects can be added to an elastic resource pool.                                                                                                                                                                            |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   | Enterprise projects let you manage cloud resources and users by project.                                                                                                                                                                                                                                            |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                           |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   |    This parameter is displayed only for users who have enabled the Enterprise Management Service.                                                                                                                                                                                                                   |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Description                       | Description about the queue.                                                                                                                                                                                                                                                                                        |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Tags                              | Tags used to identify cloud resources. A tag includes the tag key and tag value. If you want to use the same tag to identify multiple cloud resources, that is, to select the same tag from the drop-down list box for all services, you are advised to create predefined tags on the Tag Management Service (TMS). |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                           |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   |    -  A maximum of 20 tags can be added.                                                                                                                                                                                                                                                                            |
      |                                   |    -  Only one tag value can be added to a tag key.                                                                                                                                                                                                                                                                 |
      |                                   |    -  The key name in each resource must be unique.                                                                                                                                                                                                                                                                 |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   | -  Tag key: Enter a tag key name in the text box.                                                                                                                                                                                                                                                                   |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   |    .. note::                                                                                                                                                                                                                                                                                                        |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   |       A tag key can contain a maximum of 128 characters. Only letters, digits, spaces, and special characters\ ``(_.:=+-@)`` are allowed, but the value cannot start or end with a space or start with **\_sys\_**.                                                                                                 |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   | -  Tag value: Enter a tag value in the text box.                                                                                                                                                                                                                                                                    |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   |    .. note::                                                                                                                                                                                                                                                                                                        |
      |                                   |                                                                                                                                                                                                                                                                                                                     |
      |                                   |       A tag value can contain a maximum of 255 characters. Only letters, digits, spaces, and special characters\ ``(_.:=+-@)`` are allowed. The value cannot start or end with a space.                                                                                                                             |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#. Click **Next**. On the displayed page, configure a scaling policy for the queue in the elastic resource pool.

   Click Create to add a scaling policy with specified priority, period, Minimum CUs, and Maximum CUs. The parameters of each scaling policy are as follows:

   .. table:: **Table 2** Auto scaling policy

      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                                                 |
      +===================================+=============================================================================================================================================================================================================================================+
      | Priority                          | A bigger priority value indicates a higher priority. You can set a number ranging from 1 to 100.                                                                                                                                            |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Period                            | Time segment when the policy takes effects. It can be set only by hour. The start time is on the left, and the end time is on the right.                                                                                                    |
      |                                   |                                                                                                                                                                                                                                             |
      |                                   | -  The time range includes the start time but not the end time, that is, [start time, end time).                                                                                                                                            |
      |                                   |                                                                                                                                                                                                                                             |
      |                                   |    For example, if the **Period** to **01** and **17**, the scaling policy takes effect at 01:00 a.m. till 05:00 p.m.                                                                                                                       |
      |                                   |                                                                                                                                                                                                                                             |
      |                                   | -  The periods of scaling policies with different priorities cannot overlap.                                                                                                                                                                |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Min CU                            | Minimum number of CUs allowed by the scaling policy.                                                                                                                                                                                        |
      |                                   |                                                                                                                                                                                                                                             |
      |                                   | -  In any time segment of a day, the total minimum CUs of all queues in an elastic resource pool cannot be more than the minimum CUs of the pool.                                                                                           |
      |                                   | -  If the minimum CUs of the queue is less than 16 CUs, both **Max. Spark Driver Instances** and **Max. Prestart Spark Driver Instances** set in the queue properties do not apply. Refer to :ref:`Setting Queue Properties <dli_01_0563>`. |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Max CU                            | Maximum number of CUs allowed by the scaling policy.                                                                                                                                                                                        |
      |                                   |                                                                                                                                                                                                                                             |
      |                                   | In any time segment of a day, the maximum CUs of any queue in an elastic resource pool cannot be more than the maximum CUs of the pool.                                                                                                     |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. note::

      The first scaling policy is the default policy and cannot be deleted or modified.

#. Click **OK**. View all queues and scaling policies added to the elastic resource pool by referring to :ref:`Managing Queues <dli_01_0506>`.
